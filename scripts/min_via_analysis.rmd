---
title: "Minimum Viable Analysis"
author: "R Ju"
date: "10/22/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = "/Users/rju/Coursework/Phylogenetic Biology/finalproject/")
library(tidyverse)
library(ape)
```
#Data collection

To begin, I will compile a list of known Symbiodinium clade associations for species within the genus *Porites* from [coraltraits.org](coraltraits.org).

```{r data clean}

#load in coraltraits.org data and filter for relevant species and trait
por_sym <- read.csv("data/ctdb_1.1.0_data.csv") %>%
  filter(trait_name == "Symbiodinium clade" & str_detect(specie_name, "Porites")) %>%
  select(specie_id, specie_name, location_id, location_name, trait_id, trait_name, methodology_id, methodology_name, value)

#visualize data (Symbiodinium clades by species)
ggplot(por_sym) +
  geom_bar(aes(x = value, fill = value)) + 
  facet_wrap(~specie_name) + 
  labs(x = 'Symbiodinium clade',
       y = 'Observations') +
  theme_bw() + theme(panel.border = element_rect(color="black", fill=NA, size=0.75), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_blank()) 

#visualize proportion data
por_sym %>%
  count(specie_name, value) %>%
  group_by(specie_name) %>%
  mutate(prop = prop.table(n)) %>%
  ggplot() +
  geom_col(aes(x = value, y = prop, fill = value)) + 
  facet_wrap(~specie_name) + 
  labs(x = 'Symbiodinium clade',
       y = 'Proportion of observations') +
  theme_bw() + theme(panel.border = element_rect(color="black", fill=NA, size=0.75), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_blank()) 
```


###Build phylogenetic tree for genus Porites

Clade name: Porites
Taxonomy id: 46719

Outgroup: Siderastrea siderea 

####Using 18S gene

Bait sequence:
>gi|15282083|gb|AF358068.1| Nectopyramis sp. AGC-2001 small subunit ribosomal RNA gene, partial sequence
    GACAACCTGGTTGATCCTGCCAGTAGTCATATGCTTGTCTCAAAGATTAAGCCATGCATGTCTAAGTATA
    AGCACTTGTACTGTGAAACTGCGAATGGCTCATTAAATCAGTTATCGTTTATTTGATTGTACTTTACTAC
    ATGGATACCTGTGGTAATTCTAGAGCTAATACATGCGAAAAATCCCAACTTCTGGAAGGGATGTATTTAT
    TAGATTAAAAACCAATGCGAATCTTCGGGTTCGTTTTCTTGGTGATTCATGATAACTTTTCGAATCGCAT
    GGCCTAGCGCCGGCGATATTTCATTCAAATTTCTGCCCTATCAACTGTCGATGGTAAGGTATTGGCTTAC
    CATGGTTATAACGGGTGACGGAGAATTAGGGTTCGATTCCGGAGAGGGAGCCTGAGAAACGGCTACCACA
    TCTAAGGAAGGCAGCAGGCTCGAAAATTACCCAATCCCGACTCGGGGAGGTAGTGACAAGAAATAACGAT
    ACGGGGTCTTAATAGGTCTCGCAATTGGAATGAGTACAATTTAAATCCTTTAACGAGGATCAATTGGAGG
    GCAAGTCTGGTGCCAGCAGCCGCGGTAATTCCAGCTCCAATAGCGTATATTAAAGTTGTTGCAGTTAAAA
    AGCTCGTAGTTGGATTTCGGAGTGGGCCAGTTGGTCCGCCGCAAGGTGTGTTACTGACTGGTTTGCTCTT
    CTTCGCAAAGACTGCGTGTGCTCTTCGTTGAGTGTGCGTAGGATTTACGACGTTTACTTTGAAAAAATTA
    GAGTGTTCAAAGCAGGCTATTGCTTGAATACATGAGCATGGAATAATGGAATAGGACTTTGGTCCCATTT
    TGTTGGTTTCTAGGACCGAAGTAATGATTAAGAGGGACAATTGGGGGCATCCGTATTTCGTTGTCAGAGG
    TGAAATTCTTGGATTTACGAAAGACGAACAACTGCGAAAGCACTTGCCAAGAGTGTTTTCATTAATCAAG
    AACGAAAGTTAGAGGATCGAAGACGATCAGATACCGTCCTAGTTCTAACCATAAACGATGTCGACTAGGG
    ATCAGCGGGCGTTATCGTACGACCCCGTTGGCACCTTACGGGAAACCAAAGTTTCTGGATTCCGGGGGAA
    GTATAGTCGCAAGGCCGAAACTTAAAGGAATTGACGGAAGGGCACCACCAGGAGTGGAGCCTGTGGCTCA
    ATTTGACTCAACACGGGAAAACTTACCAGGTCCAGACATAGTAAGGATTGACAGGTTGAGAGCCCTTTCT
    TGATTCTGTGGGTGGTGGTGCATGGCCGTTCTTAGTTGGTGGAGTGATTTGTCTGGTTAATTCCGTTAAC
    GAACGAGACCTTAACCGGCTAAATAGTCATGCGATTCTCGAATCGTAACTGACTTCTTAGAGGGACTGTT
    GGTGTTTAACCAAAGTCAGGAAGGCAATAACAGGTCTGTGATGCCCTTAGATGTTCTGGGCCGCACGCGC
    GCTACACTGTCGGATTCAGCGAGTCTTAACCTTAACCGAAAGGTTTGGGTAATCTTTTGAAAGTCCGACG
    TGATGGGGATTGATCATTGCAATTATTGATCATGAACGAGGAATTCCTAGTAAATGCGAGTCATCAGCTC
    GCGTTGATTACGTCCCTGCCCTTTGTACACACCGCCCGTCGCTACTACCGATTGAATGGTTTAGTGAGAT
    CTTCGGATTGGCGCCGTCGCGGCCTCACGGAAGTGATGGTGCCGAAAAGTTGCTCAAACTTGATCATTTA
    GAGGAAGTAAAAGTCGTAACAAGGTTTCCGTAGGTGAACCTGCAGAAGGATCAAGCTTGGATCCCGGG


```{r}
por_phy1 <- read.tree("cluster/por.18s.alignment.fasta.treefile")
plot(por_phy1)
```

####16S

Bait sequence:
>DQ997868.1 Palythoa tuberculosa clone PtHB2 16S ribosomal RNA gene, partial sequence; mitochondrial
AAATTTTCTTAAGGAACTCGGCAAAATCCCAATGGCCCACCAGGGCATATTGGAACACGGGCCTCGACTG
TTTACCAAAAACATAGCCCTCGGCCAATATGAAAATAGATGTATAGAGGGTGATGCCTGCCCAATGGTTG
TATCTAAAAGCGGTTGATAAAAGTCGACCTCGTAAGGACAATTGAATGGCCGCGGTAACACTGACCGTGA
TAATGTAGCGTAATCAATAGCCAATTAATTGTTGGCCAGTATGAATGGCGCCACGAAGGCCCCACTGTCT
TAAGGAAATTCCCAGTGAAATTGAATTCGTAGTGAAGATGCTACGTCCAATTTGTTAGACGAAAAGACCC
CGTTGAGCTTTACTGGGGCACTTACACGGCCCCGGCCTTCCCGTGTCCGGGAACCGGCCGAATTTAAATG
GGTGGTTTAGACTATGTGGCAGCCCCCCGCCGGGGCAGATGAAACCCCACTCCCCCATGTCAAAGGGGCT
AACCCCCCCTTGGGGGGGAGAGTGTAAGTAGGACAGTTTGGTTGGGGCGACCGCCTTTTAAAGAGTAACG
AAGGTGCGCTTAAGGTGCGCAATTAATGACTGAAGCCTGACTGCGAGGGGGACACCCCGAGCAGACACCC
CTAAGCCCGCCCGAAGGGCGGCGGTGGGGTGGGCCATAGTGACCCGTTAATTTAGAGTGGAATAGTTAAC
GATCAACGAATAAAAGTTACCACGGGGATAACAGCGTAATATCGTTAGAGAGTTC

```{r}
por_phy2 <- read.tree("cluster/por.16s.alignment.fasta.treefile")
plot(por_phy2)
```

####CO1 

Bait sequence:
>MH013403.1 Palythoa tuberculosa voucher MQ53 cytochrome oxidase subunit 1 (Cox1) gene, partial cds; mitochondrial
ATATCTAATATTTGGTGTTGGGGCCGGTATGGTAGGAACAGCTTTCAGTATGTTGATAAGGTTAGAACTT
TCTGCCCCCGGAACTATGTTGGGGGACGACCATCTTTATAATGTAATCGTGACTGCGCATGCCTTTGTTA
TGATCTTTTTCCTGGTGATGCCGGTGATGATAGGGGGGTTTGGGAATTGGTTGGTGCCGCTATATATCGG
TGCACCAGATATGGCCTTCCCGCGACTAAATAACATTAGTTTCTGGCTCTTGCCCCCCGCCCTAATTCTA
TTGTTGGGTTCCGCCTTTGTGGAACAGGGGGCAGGAACAGGTTGGACGGTGTATCCGCCCCTTGCAGCCA
TTCAAGCTCATTCGGGGGGGGCCGTGGACATGGCTATATTTAGCCTCCACTTGGCCGGGGTCTCTTCCAT
CTTAGGGGCTATGAATTTTATCACCACTATATTTAATATGAGGGCCCCGGGTATGACAATGGATAGATTG
CCACTATTTGTGTGGTCTATCTTAATCACCGCCTTCTTATTGTTACTGTCTTTGCCCGTATTGGCCGGGG
CTATAACCATGCTGTTGACAGATAGGAATTTTAACACTACTTTCTTTGACCCCGCCGGAGGGGGGGACCC
GATTCTGTTTCAACATCTCTTTTGGTTTTTTGGCCATCCGGAGGTTTATATTCTAATATTGCCTGGTTTT
GGGATGATCTCCCAAATAATTCCCACCTTTGCTGCTAAAAAACAAATTTTTGGATACTTGGGCATGGTCT
ATGCAATGTTATC

```{r}
por_phy3 <- read.tree("cluster/por.co1.alignment.fasta.treefile")
plot(por_phy3)
```

